<!DOCTYPE html>
<html land="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-sacle=1.0">
    <title>WearIt</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
    <link rel="stylesheet" href="/css/style.css">
    
</head>

<body>
    <script src="/css/style.css"></script>
    <section id = "header">
        <a href="/index.html"><img src="/img/draft1.png" width="40" class="logo" alt=""></a>
        <div>
            <ul id="navbar">
                <li><a class = "active" href="/index.html">Home</a></li>
                <li><a href="/html/shop.html">Shop</a></li>
                <li><a href="/html/signup.html" id="signuplink">Sign Up</a></li>
                <li><a href="/html/login.html" id="loginlink">Login</a></li>
                <li><a href="/html/cart.html"><img id="cartbar" src="/img/shopping-cart.png" width="20"></a></li>
                <img id="close" href="#" src="/img/close.png"  width="10">
            </ul>
        </div>
        <div id="mobile">
            <img id="bar" src="/img/outdent.png"  width="20">

        </div>
        
    </section>
    <section id ="hero">
        <h4>Tread-in-offer</h4>
        <h2>Super value deals</h2>
        <h1>On all product</h1>
        <p>Save more with coupons & up to 70% off!</p>
        <button onclick="window.location.href='/html/shop.html';">Click now</button>
    </section>

    <section id = "product1" class="section-p1">
        <h2>Featured Projects</h2>
        <p>Summer Collection New Morden Design</p>
        <div class="pro-container" id="productsDiv">


        </div>
    </div>
    </section>

    <section id="banner" class="section-m1">
        <h4>Repair Services</h4>
        <h2>Up to <span>70% Off</span> - All t-shirts</h2>
        <button class="normal" onclick="window.location.href='/html/shop.html';">Explore More </button>

    </section>
    <section id = "product1" class="section-p1">
        
        <div class="pro-container" id="productsDiv2">

        </div>
    
    </section>
    <section id="sm-banner" class="section-p1">
        <div class="banner-box">
            <h4>Crazy deals</h4>
            <h2>buy 1 get 1 free</h2>
            <span>The best classic T-shirts is on sale</span>
            <button class="white" onclick="window.location.href='/html/shop.html';">Learn More</button>

        </div>
        <div class="banner-box banner-box2 ">
            <h4>Crazy deals</h4>
            <h2>buy 1 get 1 free</h2>
            <span>The best classic T-shirts is on sale</span>
            <button class="white" onclick="window.location.href='/html/shop.html';">Collection</button>

        </div>

    </section>
    <section id="banner3">
        <div class="banner-box">
            <h2>SEASON SALE</h2>
            <h3>Winter Collection -50% OFF</h3>

        </div>
        <div class="banner-box banner-box2">
            <h2>SEASON SALE</h2>
            <h3>Winter Collection -50% OFF</h3>

        </div>
        <div class="banner-box banner-box3">
            <h2>SEASON SALE</h2>
            <h3>Winter Collection -50% OFF</h3>

        </div>

    </section>

    <footer class="section-p1">
        <div class="col">
            <img class="logo" src="img/" alt="">
            <h4>Contact</h4>
            <p><strong>Address: </strong>Bangkok Thailand</p>
            <p><strong>Phone: </strong>089 133 7420</p>
            <p><strong>Hours: </strong>10:00 - 18:00,Mon - Sat</p>
            <div class="follow">
                <h4>Follow us</h4>
                <div class="icon">
                    <i class="fab fa-facebook-f"></i>
                    <i class="fab fa-youtube"></i>
                    <i class="fab fa-twitter"></i>
                    <i class="fab fa-instagram"></i>
                    <i class="fab fa-pinterest-p"></i>
                    

                </div>

            </div>
        </div>
        <div class="col">
            <h4>About</h4>
            <a href="/html/aboutus.html">About Us</a>
            <!-- <a href="#">Delivery Information</a> -->
            <!-- <a href="#">Privacy Policy</a>
            <a href="#">Terms & Conditions</a> -->
            <!-- <a href="/html/contactus.html">Contact Us</a> -->

        </div>
        <div class="col">
            <h4>My Account</h4>
            <a href="/html/signup.html">Sign Up</a>

            <a href="/html/login.html" id="loginlink">Login</a>

        </div>
        <div class="col install">
            <h4>Cart</h4>
            <a href="/html/cart.html">View Cart</a>
        </div>
        <div class="copyright">
            <p>2022, WebCreatorBro</p>
        </div>
    </footer>
    
    
    <script src="/css/style.css"></script>
    <script src="/js/script1.js"></script>
    <script type="module">

//--------------------------------ตัวแปล--------------------------------//

        const signuplink = document.getElementById("signuplink");
        const loginlink = document.getElementById("loginlink");
        var currentuser = null;
        // var currentrole = null;

//-------------------------------ฟังก์ชั่น-------------------------------//

        function getUsername(){
            currentuser = JSON.parse(sessionStorage.getItem("user"));
        }

        function Signout(){
            sessionStorage.removeItem("user");
            window.location = "index.html";
        }

//--------------------------------เมื่อโหลด--------------------------------//

        window.onload = function(){
            getUsername();
            switch(currentuser.role){
                case "admin":
                    signuplink.innerText = "Go To Admin Panel";
                    signuplink.href = "/html/admin.html";

                    loginlink.innerText = "Sign Out";
                    loginlink.href = "#";
                    loginlink.onclick = Signout;
                    break;
                case "user":
                    signuplink.innerText = currentuser.name;
                    signuplink.href = "#";

                    loginlink.innerText = "Sign Out";
                    loginlink.href = "#";
                    loginlink.onclick = Signout;
                    break;
                default:
                    signuplink.innerText = "Sign Up";
                    signuplink.href = "/html/signup.html";

                    loginlink.innerText = "Login";
                    loginlink.href = "login.html";
                    break;
            }
        }




//--------------------------------IMPORT + CONFIGURATION-------------------------------//

        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";


        const firebaseConfig = {
            apiKey: "AIzaSyBChr-7kEA30C5KceoYF0bA2LMCoHzWXzE",
            authDomain: "wearit-f97b1.firebaseapp.com",
            databaseURL: "https://wearit-f97b1-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "wearit-f97b1",
            storageBucket: "wearit-f97b1.appspot.com",
            messagingSenderId: "225288076004",
            appId: "1:225288076004:web:755e446f713c543fd14af1"
        };

        const app = initializeApp(firebaseConfig);

// --------------------import database functions---------------------//


        import { getDatabase, ref, set, child, get }
            from "https://www.gstatic.com/firebasejs/9.14.0/firebase-database.js";
        const realdb = getDatabase();

        var OuterDiv = document.getElementById('productsDiv');
        var ArrayOfProducts = [];
        window.addEventListener('load', GetAllProducts);

        function GetAllProducts() {
            const dbref = ref(realdb);

            get(child(dbref, "theProductRealdb"))
                .then((snapshot) => {
                    snapshot.forEach(prod => {
                        ArrayOfProducts.push(prod.val());
                    });
                    AddAllProducts();
                })
        }

        function AddAllProducts() {
            let i = 0;
            ArrayOfProducts.forEach(prod => {
                AddAProduct(prod, i++);
            });
            AssignAllEvent();
        }

        function AddAProduct(product, index) {
            let html =
            `
                <img class="image" id="image-`+ index +`" src="`+ product.LinksOfImages[0]+ `" alt="" width="">
                <div class="des" id="des-`+ index +`">
                    <span class="cat" id="cat-`+ index +`">`+ product.Category +`</span>
                    <h5 class="ti" id="ti-`+ index +`">`+ product.ProductTitle +`</h5>
                    <h4 class="price" id="price-`+ index +`">`+ product.Price +` ฿</h4>
                </div>
                <img src="/img/shopping-cart.png" class="cart" id="cart-`+ index +`" width="1">
            `
            

            let newProd = document.createElement('div');
            newProd.classList.add('pro');
            newProd.id = "pro-" + index;
            newProd.innerHTML = html;
            OuterDiv.append(newProd);
        }


        function getShortTitle(title) {
            if (title.length > 49) title = title.substring(0, 47);
            else return title;
            return title + "...";
        }

        function GetProductIndex(id) {
            var indstart = id.indexOf('-') + 1;
            var indend = id.length;
            return id.substring(indstart, indend);
        }

        function GotoProductDetails(event) {
            var inx = GetProductIndex(event.target.id);
            localStorage.setItem('Product', JSON.stringify(ArrayOfProducts[inx]));
            console.log(localStorage.getItem('Product'));
            window.location = '/html/sproduct.html';
        }

        function AssignAllEvent() {
            var probtns = document.getElementsByClassName('pro');
            var imgbtns = document.getElementsByClassName('image');
            var desbtns = document.getElementsByClassName('des');
            var catbtns = document.getElementsByClassName('cat');
            var tibtns = document.getElementsByClassName('ti');
            var pribtns = document.getElementsByClassName('price');
            var cartbtns = document.getElementsByClassName('cart');



            for (let i = 0; i < probtns.length; i++) {
                probtns[i].addEventListener('click', GotoProductDetails);
                imgbtns[i].addEventListener('click', GotoProductDetails);
                desbtns[i].addEventListener('click', GotoProductDetails);
                catbtns[i].addEventListener('click', GotoProductDetails);
                tibtns[i].addEventListener('click', GotoProductDetails);
                pribtns[i].addEventListener('click', GotoProductDetails);
                cartbtns[i].addEventListener('click', GotoProductDetails);
                
            }
        }

    </script>
</body>

</html>
