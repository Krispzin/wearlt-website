<!DOCTYPE html>
<html land="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-sacle=1.0">
    <title>TeteeShop</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
    <link rel="stylesheet" href="/css/style.css">
    
</head>

<body>
    <section id = "header">
        <a href="#"><img src="/img/.jpg" class="logo" alt=""></a><!--Logo website-->
        <div>
            <ul id="navbar">
                <li><a href="/html/index.html">Home</a></li>
                <li><a class="active" href="/html/shop.html">Shop</a></li>
                <li><a href="/html/signup.html" id="signuplink">Sign Up</a></li>
                <li><a href="/html/login.html" id="loginlink">Login</a></li>
                
                <li><a href="cart.html"><img id="bar" src="/img/shopping-cart.png"  width="20"></a></li>
                <img id="close" href="#" src="/img/close.png"  width="10">
            </ul>
        </div>
        <div id="mobile">
            
            <img id="bar" src="/img/outdent.png"  width="20">

        </div>
        
    </section>
    <section id ="page-header">
        
        <h2>Stay Home</h2>
        <p>Save more with coupons & up to 70% off!</p>

    </section>
    <section id = "product1" class="section-p1">
        <h2>Featured Projects</h2>
        <p>Summer Collection New Morden Design</p>


        <div class="pro-container" id="productsDiv">
            <!-- <div class="pro" onclick="window.location.href='/html/sproduct.html';">
                <img src="/img/clothestest.jpg" alt="" width="">
                <div class="des">
                    <span>adidas</span>
                    <h5>T-shirts</h5>
                    <h4>$67</h4>
                </div>
                <img  src="/img/shopping-cart.png" class="cart" width="1">
            </div> -->
        </div>

    
    </section>
    <section id="paginaction" class="section-p1"> 
        <a href ="shop.html">1</a>
        <a href ="shop2.html">2</a>
        

    </section>
    <footer class="section-p1">
        <div class="col">
            <img class="logo" src="img/" alt="">
            <h4>Contact</h4>
            <p><strong>Address: </strong>Bangkok Thailand</p>
            <p><strong>Phone: </strong>021111111 / 0311112222</p>
            <p><strong>Hours: </strong>10:00 - 18:00,Mon - Sat</p>
            <div class="follow">
                <h4>Follow us</h4>
                <div class="icon">
                    <i class="fab fa-facebook-f"></i>
                    <i class="fab fa-youtube"></i>
                    <i class="fab fa-twitter"></i>
                    <i class="fab fa-instagram"></i>
                    <i class="fab fa-pinterest-p"></i>
                </div>

            </div>
        </div>
        <div class="col">
            <h4>About</h4>
            <a href="#">About Us</a>
            <a href="#">Delivery Information</a>
            <a href="#">Privacy Policy</a>
            <a href="#">Terms & Conditions</a>
            <a href="#">Contact Us</a>

        </div>
        <div class="col">
            <h4>My Account</h4>
            <a href="#">Sing In</a>
            <a href="#">View Cart</a>
            <a href="#">My Wishlist</a>
            <a href="#">Track My Order</a>
            <a href="#">Help</a>

        </div>
        <div class="col install">
            <h4>Install App</h4>
            <p>Form App Store or Google Play</p>
        </div>
        <div class="copyright">
            <p>2021, Tech2 etc - HTML CSS Ecommerce Template</p>

        </div>


    </footer>

    
    
    <script src="/css/style.css"></script>
    <script type="module">

//--------------------------------ตัวแปล--------------------------------//
        
        const signuplink = document.getElementById("signuplink");
        const loginlink = document.getElementById("loginlink");
        var currentuser = null;
        
//-------------------------------ฟังก์ชั่น-------------------------------//
        
        function getUsername(){
            currentuser = JSON.parse(sessionStorage.getItem("user"));
        }

        function Signout(){
            sessionStorage.removeItem("user");
            window.location = "index.html";
        }

//--------------------------------เมื่อโหลด--------------------------------//
        
        window.onload = function(){
            getUsername();
            if(currentuser != null){
                signuplink.innerText = currentuser.name;
                signuplink.href = "#";

                loginlink.innerText = "Sign Out";
            }

            else {
                signuplink.innerText = "Sign Up";
                loginlink.innerText = "Login";
            }
        }

//--------------------------------IMPORT + CONFIGURATION-------------------------------//

        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";


        const firebaseConfig = {
            apiKey: "AIzaSyBChr-7kEA30C5KceoYF0bA2LMCoHzWXzE",
            authDomain: "wearit-f97b1.firebaseapp.com",
            databaseURL: "https://wearit-f97b1-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "wearit-f97b1",
            storageBucket: "wearit-f97b1.appspot.com",
            messagingSenderId: "225288076004",
            appId: "1:225288076004:web:755e446f713c543fd14af1"
        };

        const app = initializeApp(firebaseConfig);

// --------------------import database functions---------------------//


        import { getDatabase, ref, set, child, get }
            from "https://www.gstatic.com/firebasejs/9.14.0/firebase-database.js";
        const realdb = getDatabase();

        var OuterDiv = document.getElementById('productsDiv');
        var ArrayOfProducts = [];
        window.addEventListener('load', GetAllProducts);

        function GetAllProducts() {
            const dbref = ref(realdb);

            get(child(dbref, "theProductRealdb"))
                .then((snapshot) => {
                    snapshot.forEach(prod => {
                        ArrayOfProducts.push(prod.val());
                    });
                    AddAllProducts();
                })
        }

        function AddAllProducts() {
            let i = 0;
            ArrayOfProducts.forEach(prod => {
                AddAProduct(prod, i++);
            });
            AssignAllEvent();
        }

        function AddAProduct(product, index) {
            let html =
            // `
            // <img src="`+ product.LinksOfImages[0] + `" class="thumb mt-2" id="thumb-` + index + `">
            // <p class="title" id="title-`+ index + `">` + getShortTitle(product.ProductTitle) + `</p>
            // <h5 class="price">`+ product.Price + ` Thai baht</h5>
            // <button class="detbtns btn" id="detbtn-`+ index + `">View Details</button>
            // `

            `
            <div class="pro" id="pro-`+ index +`">
                <img class="image" src="`+ product.LinksOfImages[0] + `" alt="" width="">
                <div class="des">
                    <span>`+ product.Category +`</span>
                    <h5>`+ product.ProductTitle +`</h5>
                    <h4>`+ product.Price +` ฿</h4>
                </div>
                <img src="/img/shopping-cart.png" class="cart" width="1">
            </div>
            `

            let newProd = document.createElement('div');
            newProd.classList.add('productcard');
            newProd.innerHTML = html;
            OuterDiv.append(newProd);
        }

        // function GetUl(array){
        //     let ul = document.createElement('ul');
        //     ul.classList.add('points');

        //     array.forEach(element => {
        //         let li = document.createElement('li');
        //         li.innerText=element;
        //         ul.append(li);
        //     });
        //     return ul.outerHTML;
        // }

        function getShortTitle(title) {
            if (title.length > 49) title = title.substring(0, 47);
            else return title;
            return title + "...";
        }

        // function GenerateStockLabel(stock){
        //     let stocklabel = document.createElement('h5');
        //     stocklabel.classList.add('stock');

        //     if(stock > 0){
        //         stocklabel.innerHTML = 'In Stock';
        //         stocklabel.classList.add('text-success');
        //     }
        //     else{
        //         stocklabel.innerHTML = 'Out of Stock';
        //         stocklabel.classList.add('text-warning');
        //     }
        //     return stocklabel.outerHTML;
        // }

        function GetProductIndex(id) {
            var indstart = id.indexOf('-') + 1;
            var indend = id.length;
            return id.substring(indstart, indend);
        }

        function GotoProductDetails(event) {
            var index = GetProductIndex(event.target.id);
            localStorage.Product = JSON.stringify(ArrayOfProducts[index]);
            window.location = 'sproduct.html';
        }

        function AssignAllEvent() {
            var probtns = document.getElementsByClassName('pro');
            var imgbtn = document.getElementsByClassName('image');

            for (let i = 0; i < probtns.length; i++) {
                probtns[i].addEventListener('click', GotoProductDetails);
                imgbtn[i].addEventListener('click', GotoProductDetails);
            }
        }
        
    </script>
</body>

</html>
